<#
.SYNOPSIS
    Remediates STIG ID WN11-CC-000005 by preventing the use of the lock screen camera
    through a policy-backed registry configuration equivalent to enabling the
    Local Group Policy setting.

.DESCRIPTION
    WN11-CC-000005 requires that the lock screen camera be disabled.
    This control is enforced via an Administrative Template policy and evaluated
    based on the presence and value of the corresponding registry key.

    This script:
      - Creates the required policy registry path if it does not exist
      - Sets the NoLockScreenCamera DWORD value to 1 (Enabled)
      - Verifies the applied configuration

.NOTES
    Author          : Jordan Calvert
    STIG-ID         : WN11-CC-000005
    Version         : 1.0
    Tested On       : Windows 11 Pro
    Requires        : Elevated PowerShell session

.USAGE
    Run PowerShell as Administrator:
    PS C:\> Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass
    PS C:\> .\__template_remediation-STIG-ID-WN11-CC-000005.ps1
#>

# Define registry path and value
$RegPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\Personalization"
$RegName = "NoLockScreenCamera"
$RegValue = 1

Write-Host "[*] Remediating STIG WN11-CC-000005..." -ForegroundColor Cyan

# Ensure registry path exists
if (-not (Test-Path $RegPath)) {
    Write-Host "[*] Creating registry path: $RegPath"
    New-Item -Path $RegPath -Force | Out-Null
}

# Set policy-backed registry value
Write-Host "[*] Setting NoLockScreenCamera DWORD to 1"
New-ItemProperty `
    -Path $RegPath `
    -Name $RegName `
    -PropertyType DWord `
    -Value $RegValue `
    -Force | Out-Null

# Verify configuration
$CurrentValue = Get-ItemProperty -Path $RegPath -Name $RegName -ErrorAction SilentlyContinue

if ($CurrentValue.$RegName -eq 1) {
    Write-Host "[+] Remediation successful. Lock screen camera is disabled." -ForegroundColor Green
} else {
    Write-Host "[!] Remediation failed. Registry value not set as expected." -ForegroundColor Red
}

Write-Host "[*] Policy will reflect as 'Enabled' in Local Group Policy Editor."
Write-Host "[*] A Group Policy refresh or system reboot may be required for full enforcement."

