<#
.SYNOPSIS
    Intentionally weakens Linux account security by modifying file permissions.

.DESCRIPTION
    This script connects to a Linux system over SSH and executes commands
    that create a severe security vulnerability by granting world-writable
    permissions to /etc/shadow and /etc/passwd.

    ⚠️ WARNING: This is intentionally insecure and should ONLY be used
    in isolated lab environments for vulnerability demonstration purposes.
#>

# --- Configuration ---
$LinuxHost   = "192.168.1.50"     # <-- Update to your lab VM IP
$Username    = "labuser"          # <-- Update as needed
$Password    = "Password123!"     # <-- Your intentionally bad lab password

# Convert to secure string
$SecurePass  = ConvertTo-SecureString $Password -AsPlainText -Force
$Cred        = New-Object System.Management.Automation.PSCredential ($Username, $SecurePass)

Write-Host "`n=== Creating Linux Permission Vulnerability ===" -ForegroundColor Yellow

# Commands that introduce the vulnerability
$Commands = @(
    "sudo chmod 777 /etc/shadow",
    "sudo chmod 777 /etc/passwd"
)

try {
    foreach ($cmd in $Commands) {
        Write-Host "[*] Executing: $cmd" -ForegroundColor Cyan
        $result = ssh $Cred@$LinuxHost $cmd
        Write-Host $result
    }

    Write-Host "`n[+] Vulnerability successfully created: /etc/shadow and /etc/passwd are world-writable." -ForegroundColor Green
}
catch {
    Write-Error "Failed to execute commands: $($_.Exception.Message)"
}

Write-Host "=== Operation Complete ===`n"
