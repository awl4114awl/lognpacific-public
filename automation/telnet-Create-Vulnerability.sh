#!/bin/bash
#
# telnet-Create-Vulnerability.sh
# ------------------------------
# Intentionally weakens Linux system security by installing and enabling
# the Telnet server. This is used exclusively for Cyber Range vulnerability
# creation labs.
#

set -e

echo -e "\n=== Telnet Vulnerability Creation Starting ===\n"

# -------------------------------------------------------------
# 1. Update package lists
# -------------------------------------------------------------
echo "[1/4] Updating package lists..."
sudo apt update -y
echo "✓ Packages updated."

# -------------------------------------------------------------
# 2. Install telnetd + inetd service manager
# -------------------------------------------------------------
echo "[2/4] Installing telnetd and inetutils-inetd..."
sudo apt install -y telnetd inetutils-inetd
echo "✓ Telnet server installed."

# -------------------------------------------------------------
# 3. Enable inetd service
# -------------------------------------------------------------
echo "[3/4] Enabling inetd.service..."
if sudo systemctl enable inetd.service 2>/dev/null; then
    echo "✓ inetd.service enabled."
else
    echo "ℹ inetd.service not found — check system compatibility."
fi

# -------------------------------------------------------------
# 4. Start inetd service
# -------------------------------------------------------------
echo "[4/4] Starting inetd.service..."
if sudo systemctl start inetd.service 2>/dev/null; then
    echo "✓ inetd.service started."
else
    echo "ℹ inetd.service could not be started — may not exist on this system."
fi

echo -e "\n=== Telnet Vulnerability Successfully Created ===\n"
